Farm = {
	Data = {
		IsFarmer = false,
		OnDuty = false,
		Fields = {
			{
				Crop = {
					Model = "prop_veg_crop_02",
					ZOffset = 1.2,
					Radius = 0,
					Time = 0,
				},
				Path = {
					{x = 2139.2197265625, y = 5204.58984375, z = 57.967384338379, h = 222.92823791504},
					{x = 2152.6196289063, y = 5190.1821289063, z = 57.658283233643, h = 227.56965637207},
					{x = 2165.46875, y = 5176.5009765625, z = 56.574676513672, h = 221.39002990723},
					{x = 2176.4331054688, y = 5165.2553710938, z = 55.374755859375, h = 222.63534545898},
					{x = 2184.6154785156, y = 5154.5512695313, z = 54.339241027832, h = 218.55126953125},
					{x = 2179.9187011719, y = 5149.3862304688, z = 53.276100158691, h = 40.935932159424},
					{x = 2170.7492675781, y = 5159.4213867188, z = 54.328994750977, h = 41.886528015137},
					{x = 2162.287109375, y = 5168.8237304688, z = 55.345027923584, h = 41.230667114258},
					{x = 2153.2097167969, y = 5179.1606445313, z = 56.510143280029, h = 41.188777923584},
					{x = 2144.3393554688, y = 5188.6450195313, z = 57.136264801025, h = 42.395668029785},
					{x = 2131.1901855469, y = 5202.5346679688, z = 57.382740020752, h = 42.381298065186},
					{x = 2117.0744628906, y = 5201.4780273438, z = 56.972560882568, h = 222.84661865234},
					{x = 2130.1469726563, y = 5187.37109375, z = 56.1262550354, h = 221.93063354492},
					{x = 2142.9892578125, y = 5173.4526367188, z = 55.105255126953, h = 222.30061340332},
					{x = 2156.3784179688, y = 5159.0478515625, z = 53.422103881836, h = 223.20732116699},
					{x = 2167.6669921875, y = 5147.068359375, z = 51.930042266846, h = 223.28608703613},
					{x = 2171.275390625, y = 5136.5620117188, z = 50.440738677979, h = 95.813278198242},
					{x = 2159.0236816406, y = 5142.2270507813, z = 50.543270111084, h = 39.783466339111},
					{x = 2144.4030761719, y = 5157.75, z = 52.553592681885, h = 44.132007598877},
					{x = 2130.5439453125, y = 5173.177734375, z = 54.139896392822, h = 43.494316101074},
					{x = 2115.482421875, y = 5189.1875, z = 55.473747253418, h = 43.129261016846},
					{x = 2105.1682128906, y = 5200.5209960938, z = 56.107067108154, h = 41.263507843018},
					{x = 2104.8383789063, y = 5185.8637695313, z = 54.799167633057, h = 224.35699462891},
					{x = 2118.8239746094, y = 5170.7465820313, z = 53.287017822266, h = 223.65028381348},
					{x = 2135.9926757813, y = 5152.4287109375, z = 51.324996948242, h = 223.2887878418},
					{x = 2150.8479003906, y = 5136.39453125, z = 49.334426879883, h = 223.2599029541},
					{x = 2150.564453125, y = 5123.8081054688, z = 47.535781860352, h = 39.905387878418},
					{x = 2135.4165039063, y = 5139.6708984375, z = 49.306301116943, h = 42.454502105713},
					{x = 2119.4792480469, y = 5156.4130859375, z = 51.437072753906, h = 44.171436309814},
					{x = 2105.7609863281, y = 5171.0454101563, z = 53.037738800049, h = 42.790702819824},
					{x = 2093.1989746094, y = 5184.8725585938, z = 54.355484008789, h = 41.880191802979},
					{x = 2086.0600585938, y = 5180.2783203125, z = 53.282341003418, h = 222.86201477051},
					{x = 2100.2255859375, y = 5164.2685546875, z = 51.503463745117, h = 221.83311462402},
					{x = 2115.5515136719, y = 5147.8349609375, z = 49.969303131104, h = 223.38902282715},
					{x = 2132.9367675781, y = 5129.4794921875, z = 47.76273727417, h = 223.12199401855},
					{x = 2144.6342773438, y = 5117.5576171875, z = 46.472198486328, h = 223.10386657715},
				},
				CurrentPath = 1,
				Centre = {x = 2194.17, y = 5152.88},
				Longest = 125.01,
				Points = {
					{x = 2136.62, y = 5215.57, z = 58.55},
					{x = 2111.4, y = 5212.23, z = 57.04},
					{x = 2089.43, y = 5200.24, z = 55.58},
					{x = 2074.58, y = 5186.62, z = 53.41},
					{x = 2145.17, y = 5109.4, z = 46.45},
					{x = 2166.02, y = 5126.91, z = 48.31},
					{x = 2168.68, y = 5124.79, z = 48.11},
					{x = 2189.35, y = 5144.53, z = 53.43},
					{x = 2194.17, y = 5152.88, z = 54.8},
				},
				Blip = {
					Name = "Strawberry Field"
					Coordinates = {x = 2144.7333984375, y = 5163.5629882813, z = 53.567691802979, h = 321.29647827148},
					Sprite = 162,
					Colour = 59,
				},
				Raked = false,
			},
			{
				Crop = {
					Model = "prop_veg_crop_03_cab",
					ZOffset = 1,
					Radius = 0,
					Time = 0,
				},
				Path = {
					{x = 2045.6480712891, y = 4963.841796875, z = 41.097553253174, h = 222.77256774902},
					{x = 2057.9948730469, y = 4951.595703125, z = 41.089862823486, h = 223.6927947998},
					{x = 2074.0329589844, y = 4935.6318359375, z = 41.104644775391, h = 225.35578918457},
					{x = 2084.359375, y = 4925.755859375, z = 41.090915679932, h = 225.00631713867},
					{x = 2091.8505859375, y = 4918.2016601563, z = 41.076560974121, h = 223.43830871582},
					{x = 2087.3391113281, y = 4914.3999023438, z = 41.083904266357, h = 42.988788604736},
					{x = 2073.9633789063, y = 4927.7172851563, z = 41.109428405762, h = 43.364658355713},
					{x = 2062.5393066406, y = 4939.0698242188, z = 41.109447479248, h = 44.413928985596},
					{x = 2052.7331542969, y = 4948.5458984375, z = 41.063541412354, h = 44.336410522461},
					{x = 2042.1463623047, y = 4959.1762695313, z = 41.101184844971, h = 44.807861328125},
					{x = 2038.4544677734, y = 4954.1245117188, z = 41.087535858154, h = 228.8698425293},
					{x = 2049.1921386719, y = 4943.2612304688, z = 41.105430603027, h = 224.65797424316},
					{x = 2059.3186035156, y = 4933.1547851563, z = 41.018966674805, h = 225.62405395508},
					{x = 2071.443359375, y = 4921.462890625, z = 41.091915130615, h = 224.83502197266},
					{x = 2083.6372070313, y = 4909.4736328125, z = 41.072227478027, h = 225.85232543945},
					{x = 2079.220703125, y = 4905.4057617188, z = 41.095149993896, h = 42.30054473877},
					{x = 2066.5571289063, y = 4918.2431640625, z = 41.109901428223, h = 44.108501434326},
					{x = 2054.5942382813, y = 4930.1416015625, z = 41.06859588623, h = 45.833423614502},
					{x = 2041.8919677734, y = 4942.3037109375, z = 41.109001159668, h = 45.76163482666},
					{x = 2033.4504394531, y = 4950.59765625, z = 41.079032897949, h = 45.27322769165},
					{x = 2029.2475585938, y = 4946.55078125, z = 41.079456329346, h = 225.67222595215},
					{x = 2042.9420166016, y = 4932.8422851563, z = 41.117599487305, h = 224.88066101074},
					{x = 2052.6022949219, y = 4923.302734375, z = 40.961154937744, h = 225.79502868652},
					{x = 2063.6645507813, y = 4912.4506835938, z = 41.081268310547, h = 225.31269836426},
					{x = 2074.5490722656, y = 4901.7280273438, z = 41.06986618042, h = 225.484375},
					{x = 2070.5073242188, y = 4897.1455078125, z = 41.07434463501, h = 44.149555206299},
					{x = 2056.0444335938, y = 4911.9321289063, z = 41.072956085205, h = 44.159194946289},
					{x = 2044.3995361328, y = 4923.126953125, z = 41.116214752197, h = 45.974922180176},
					{x = 2032.9654541016, y = 4934.2690429688, z = 41.086460113525, h = 45.80680847168},
					{x = 2024.2891845703, y = 4942.9072265625, z = 41.080940246582, h = 45.26305770874},
					{x = 2021.0986328125, y = 4937.3291015625, z = 41.07120513916, h = 223.9938659668},
					{x = 2034.8764648438, y = 4923.7475585938, z = 41.053520202637, h = 226.25804138184},
					{x = 2047.2203369141, y = 4911.5415039063, z = 41.062255859375, h = 225.07081604004},
					{x = 2058.435546875, y = 4900.0244140625, z = 41.103004455566, h = 223.36735534668},
					{x = 2066.3684082031, y = 4892.30859375, z = 41.103214263916, h = 225.66998291016},
				},
				CurrentPath = 1,
				Centre = {x = 2100.84, y = 4917.95},
				Longest = 91.01,
				Points = {
					{x = 2045.88, y = 4971.74, z = 41.38},
					{x = 2012.98, y = 4939.68, z = 41.51},
					{x = 2068.31, y = 4885.09, z = 41.52},
					{x = 2100.84, y = 4917.95, z = 41.32},
				},
				Blip = {
					Name = "Cabbage Field"
					Coordinates = {x = 2057.3491210938, y = 4927.9052734375, z = 40.961162567139, h = 43.524127960205},
					Sprite = 162,
					Colour = 2,
				},
				Raked = false,
			},
			{
				Crop = {
					Model = "prop_veg_crop_03_pump",
					ZOffset = 1,
					Radius = 0,
					Time = 0,
				},
				Path = {
					{x = 2006.7590332031, y = 4923.978515625, z = 42.887752532959, h = 225.39208984375},
					{x = 2018.2106933594, y = 4912.626953125, z = 42.887218475342, h = 225.67074584961},
					{x = 2030.6391601563, y = 4900.5400390625, z = 42.867481231689, h = 225.88130187988},
					{x = 2041.7795410156, y = 4889.3969726563, z = 42.873706817627, h = 224.80860900879},
					{x = 2051.923828125, y = 4879.240234375, z = 42.861198425293, h = 224.04693603516},
					{x = 2048.2163085938, y = 4874.4794921875, z = 42.872226715088, h = 46.095539093018},
					{x = 2035.8486328125, y = 4887.0688476563, z = 42.883190155029, h = 43.972438812256},
					{x = 2022.357421875, y = 4900.2939453125, z = 42.88610458374, h = 46.666809082031},
					{x = 2011.3701171875, y = 4910.9775390625, z = 42.872547149658, h = 45.544429779053},
					{x = 2002.5103759766, y = 4919.73828125, z = 42.89098739624, h = 45.405288696289},
					{x = 1998.5600585938, y = 4915.1791992188, z = 42.87077331543, h = 221.72280883789},
					{x = 2011.1948242188, y = 4902.5092773438, z = 42.878173828125, h = 225.16444396973},
					{x = 2024.8226318359, y = 4889.2133789063, z = 42.857494354248, h = 225.77694702148},
					{x = 2036.0297851563, y = 4878.1870117188, z = 42.870403289795, h = 225.5923614502},
					{x = 2044.3186035156, y = 4870.1166992188, z = 42.871471405029, h = 225.82220458984},
					{x = 2039.1599121094, y = 4866.4995117188, z = 42.878009796143, h = 44.391498565674},
					{x = 2027.1353759766, y = 4878.5747070313, z = 42.875175476074, h = 44.514171600342},
					{x = 2014.1794433594, y = 4891.2612304688, z = 42.862670898438, h = 46.126724243164},
					{x = 2002.4346923828, y = 4902.8549804688, z = 42.899841308594, h = 44.920322418213},
					{x = 1992.5234375, y = 4912.7158203125, z = 42.858631134033, h = 45.234233856201},
					{x = 1989.5242919922, y = 4907.2104492188, z = 42.868274688721, h = 221.90731811523},
					{x = 2002.2595214844, y = 4894.7880859375, z = 42.907344818115, h = 225.93017578125},
					{x = 2015.5739746094, y = 4881.5366210938, z = 42.885997772217, h = 225.00149536133},
					{x = 2028.2764892578, y = 4869.2333984375, z = 42.855213165283, h = 226.76081848145},
					{x = 2036.2822265625, y = 4861.0732421875, z = 42.852195739746, h = 224.40977478027},
					{x = 2031.4357910156, y = 4857.1416015625, z = 42.88321685791, h = 43.589530944824},
					{x = 2019.9315185547, y = 4868.3984375, z = 42.853000640869, h = 45.563205718994},
					{x = 2009.2966308594, y = 4878.8862304688, z = 42.746311187744, h = 45.307704925537},
					{x = 1998.5595703125, y = 4889.1103515625, z = 42.89672088623, h = 47.190963745117},
					{x = 1986.2578125, y = 4901.6821289063, z = 42.853866577148, h = 44.364688873291},
				},
				CurrentPath = 1,
				Centre = {x = 2061.86, y = 4878.13},
				Longest = 90.01,
				Points = {
					{x = 2006.34, y = 4932.25, z = 43.1},
					{x = 1975.71, y = 4902.87, z = 43.44},
					{x = 2031.27, y = 4848.01, z = 43.2},
					{x = 2061.86, y = 4878.13, z = 43.12},
				},
				Blip = {
					Name = "Pumpkin Field"
					Coordinates = {x = 2019.2624511719, y = 4890.7119140625, z = 42.697128295898, h = 44.916187286377},
					Sprite = 162,
					Colour = 64,
				},
				Raked = false,
			},
			{
				Crop = {
					Model = "prop_veg_crop_orange",
					ZOffset = 1.5,
					Radius = 0,
					Time = 0,
				},
				Path = {
					{x = 2296.9221191406, y = 5166.50390625, z = 57.732807159424, h = 225.7225189209},
					{x = 2312.9211425781, y = 5151.1772460938, z = 52.917407989502, h = 219.95747375488},
					{x = 2329.9536132813, y = 5134.5795898438, z = 49.399040222168, h = 226.16844177246},
					{x = 2343.537109375, y = 5121.1323242188, z = 48.278022766113, h = 225.53634643555},
					{x = 2340.8046875, y = 5109.79296875, z = 47.826496124268, h = 41.802024841309},
					{x = 2325.2192382813, y = 5124.880859375, z = 48.721061706543, h = 44.561832427979},
					{x = 2310.982421875, y = 5138.935546875, z = 51.212688446045, h = 44.465774536133},
					{x = 2295.1428222656, y = 5154.9956054688, z = 55.086799621582, h = 44.708190917969},
					{x = 2283.9516601563, y = 5148.5483398438, z = 54.631080627441, h = 220.81671142578},
					{x = 2300.1643066406, y = 5132.3032226563, z = 51.110473632813, h = 221.27053833008},
					{x = 2317.1567382813, y = 5115.2416992188, z = 48.269580841064, h = 224.53028869629},
					{x = 2331.5666503906, y = 5101.2939453125, z = 47.074626922607, h = 220.58619689941},
					{x = 2323.0034179688, y = 5093.9252929688, z = 46.610748291016, h = 42.693725585938},
					{x = 2306.4619140625, y = 5110.6791992188, z = 48.325046539307, h = 44.272266387939},
					{x = 2288.5207519531, y = 5128.5961914063, z = 51.099899291992, h = 43.66960144043},
					{x = 2273.8659667969, y = 5142.8891601563, z = 54.353061676025, h = 45.424297332764},
					{x = 2267.2019042969, y = 5135.390625, z = 53.699756622314, h = 219.29611206055},
					{x = 2282.1889648438, y = 5121.1005859375, z = 50.747352600098, h = 223.72296142578},
					{x = 2295.5407714844, y = 5107.8754882813, z = 48.794994354248, h = 225.10130310059},
					{x = 2310.7155761719, y = 5093.244140625, z = 47.259983062744, h = 225.29078674316},
				},
				CurrentPath = 1,
				Centre = {x = 2307.73, y = 5085.09},
				Longest = 92.01,
				Points = {
					{x = 2256.62, y = 5134.9, z = 53.61},
					{x = 2296.9, y = 5176.13, z = 59.7},
					{x = 2357.47, y = 5116.15, z = 47.82},
					{x = 2327.96, y = 5085.03, z = 46.0},
					{x = 2307.73, y = 5085.09, z = 46.7},
				},
				Blip = {
					Name = "Orange Field"
					Coordinates = {x = 2308.2817382813, y = 5123.6552734375, z = 49.650482177734, h = 37.763072967529},
					Sprite = 162,
					Colour = 47,
				},
				Raked = false,
			},
		},
		Planted = {},
		Players = {},
		Scenario = "WORLD_HUMAN_GARDENER_PLANT",
		Vehicle = {
			Model = "tractor2",
			Trailer = {
				Model = "raketrailer",
			},
		},
	},
}

Utilities = {}

function CreateBlip(Str, Sprite, Colour, X, Y, Z, Scale, ShortRange)
	if tonumber(X) and tonumber(Y) and tonumber(Z) then
		local Blip = AddBlipForCoord(X, Y, Z)
		SetBlipSprite(Blip, Sprite or 1)
		SetBlipColour(Blip, Colour or 1)
		SetBlipScale(Blip, Scale or 0.6)
		SetBlipAsShortRange(Blip, ShortRange or true)
		BeginTextCommandSetBlipName("STRING")
		AddTextComponentString(Str)
		EndTextCommandSetBlipName(Blip)
		return Blip
	end
end

function GetByteCount(str)
    local bytes = 0

    for c in str:gmatch("[%z\1-\127\194-\244][\128-\191]*") do
        local a,b,c,d = c:byte(1, -1)
        if a ~= nil then
            bytes = bytes + 1
        end
        if b ~= nil then
            bytes = bytes + 1
        end
        if c ~= nil then
            bytes = bytes + 1
        end
        if d ~= nil then
            bytes = bytes + 1
        end
    end
    return bytes
end

function Utilities.DisplayHelpText(Str)
	BeginTextCommandDisplayHelp("STRING")
	AddTextComponentString(Str or "")
	EndTextCommandDisplayHelp(0, 0, 0, -1)
end

function Utilities.RenderMarker(Type, X, Y, Z, SX, SY, SZ, R, G, B, A, BobUpAndDown)
	if tonumber(X) and tonumber(Y) and tonumber(Z) then
		DrawMarker(Type, X, Y, Z - 0.9, 0, 0, 0, 0, 0, 0, SX or 0, SY or 0, SZ or 0, R or 255, G or 255, B or 255, A or 255, BobUpAndDown or false, 0, 2, 0, 0, 0, 0)
	end
end

function Utilities.Subtitle(Message, Duration)
	local MaxStringLength = 99
	local MessageLength = GetByteCount(Message)


	BeginTextCommandPrint("STRING")

	local Index = 1
	for Index = 1, MessageLength, MaxStringLength do
		AddTextComponentSubstringPlayerName(string.sub(Message, Index, math.min(MaxStringLength, MessageLength - Index)))
	end

	EndTextCommandPrint(tonumber(Duration) or 2000, false)
end

function IsLeft(point0, point1, point2)
	return (((point1.x - point0.x) * (point2.y - point0.y)) - ((point2.x - point0.x) * (point1.y - point0.y)))
end

function IsPointInPolygon(point, points)
	local winding_number = 0

	table.insert(points, points[1])

	for i = 1, #points - 1, 1 do
		if points[i].y <= point.y then
			if points[i+1].y > point.y then
				if IsLeft(points[i], points[i+1], point) > 0 then
					winding_number = winding_number + 1
				end
			end
		else
			if points[i+1].y <= point.y then
				if IsLeft(points[i], points[i+1], point) < 0 then
					winding_number = winding_number - 1
				end
			end
		end
	end

	table.remove(points, #points)

	return winding_number
end

function Farm:CreateCrop(Field, PlayerPosiiton)
	RequestModel(Field.Crop.ModelHash)

	while not HasModelLoaded(Field.Crop.ModelHash) do
		Citizen.Wait(0)
	end

	local Crop = CreateObject(Field.Crop.ModelHash, PlayerPosiiton.x, PlayerPosiiton.y, PlayerPosiiton.z - Field.Crop.ZOffset, true, false, false)

	FreezeEntityPosition(Crop, true)

	table.insert(Farm.Data.Planted, {
		Handle = Crop,
		Time = Field.Crop.Time,
	})

end

function Farm:IsCropOwnedByPlayer(Crop)
	for Index = 1, #Farm.Data.Planted do
		if Crop == Farm.Data.Planted[Index].Handle then
			return true
		end
	end
	return false
end

function Farm:IsPlayerNearCrop(Field, PlayerPosition)
	local ClosestCrop = GetClosestObjectOfType(PlayerPosition.x, PlayerPosition.y, PlayerPosition.z, Field.Crop.Radius, Field.Crop.ModelHash, false, false, false)
	return (ClosestCrop ~= 0) and true or false, ClosestCrop
end

function Farm:IsPlayerInField(Field, PlayerPosition)
	if Vdist(Field.Centre.x, Field.Centre.y, 0, PlayerPosition.x, PlayerPosition.y, 0) < Field.Longest then
		if IsPointInPolygon(PlayerPosition, Field.Points) ~= 0 then
			return true
		else
			return false
		end
	else
		return false
	end
end

function Farm:ManagePlantedCrops()
	for Index = 1, #Farm.Data.Planted do
		Farm.Data.Planted[Index].Time = Farm.Data.Planted[Index].Time - 1
	end
end

function Farm:ManageFields(PlayerPed, PlayerPosition)
	for Index = 1, #Farm.Data.Fields do
		if self:IsPlayerInField(Farm.Data.Fields[Index], PlayerPosition) then
			if Farm.Data.Fields[Index].Raked then
				Farm.Data.Fields[Index].CurrentPath = 1

				if not IsPedInAnyVehicle(PlayerPed, false) then
					local NearCrop, ClosestCrop = self:IsPlayerNearCrop(Farm.Data.Fields[Index], PlayerPosition)

					if NearCrop then
						if self:IsCropOwnedByPlayer(ClosestCrop) then

						end
					else
						if not IsPedUsingScenario(PlayerPed, Farm.Data.Scenario) then
							Utilities.DisplayHelpText("Press ~INPUT_CONTEXT~ to plant a seed!")
							if IsControlJustPressed(1, 51) then
								Citizen.CreateThread(function()
									TaskStartScenarioInPlace(PlayerPed, Farm.Data.Scenario, 0, false)
									Citizen.Wait(4000)
									ClearPedTasks(PlayerPed)
									self:CreateCrop(Farm.Data.Fields[Index], PlayerPosition)
								end)
							end
						else
							Utilities.DisplayHelpText("Planting seed...")
						end
					end
				end
			else
				if Farm.Data.Fields[Index].CurrentPath <= #Farm.Data.Fields[Index].Path then
					if IsPedInAnyVehicle(PlayerPed, false) then
						local PlayerVehicle = GetVehiclePedIsUsing(PlayerPed)
						if DoesEntityExist(PlayerVehicle) then
							if GetEntityModel(PlayerVehicle) == Farm.Data.Vehicle.ModelHash then
								local _, Trailer = GetVehicleTrailerVehicle(PlayerVehicle)
								if GetEntityModel(Trailer) == Farm.Data.Vehicle.Trailer.ModelHash then
									Utilities.RenderMarker(25, Farm.Data.Fields[Index].Path[Farm.Data.Fields[Index].CurrentPath].x, Farm.Data.Fields[Index].Path[Farm.Data.Fields[Index].CurrentPath].y, Farm.Data.Fields[Index].Path[Farm.Data.Fields[Index].CurrentPath].z, 1.5, 1.5, 2.0, 255, 0, 0, 100)

									if Vdist(PlayerPosition.x, PlayerPosition.y, PlayerPosition.z, Farm.Data.Fields[Index].Path[Farm.Data.Fields[Index].CurrentPath].x, Farm.Data.Fields[Index].Path[Farm.Data.Fields[Index].CurrentPath].y, Farm.Data.Fields[Index].Path[Farm.Data.Fields[Index].CurrentPath].z) < 2.5 then
										Utilities.Subtitle("Raked patch ~b~"..Farm.Data.Fields[Index].CurrentPath.."~w~ of ~b~"..#Farm.Data.Fields[Index].Path.."!")
										Farm.Data.Fields[Index].CurrentPath = Farm.Data.Fields[Index].CurrentPath + 1
									end
								end
							end
						end
					end
				else
					Farm.Data.Fields[Index].Raked = true
					TriggerServerEvent("Farm.Raked", Index)
					Utilities.Subtitle("The field has been raked successfully!")
				end
			end
		end
	end
end

Citizen.CreateThread(function()
	for Index = 1, #Farm.Data.Fields do
		Farm.Data.Fields[Index].Crop.ModelHash = GetHashKey(Farm.Data.Fields[Index].Crop.Model)
	end

	Farm.Data.Vehicle.ModelHash = GetHashKey(Farm.Data.Vehicle.Model)
	Farm.Data.Vehicle.Trailer.ModelHash = GetHashKey(Farm.Data.Vehicle.Trailer.Model)

	while true do
		Citizen.Wait(0)
		local PlayerPed = PlayerPedId()
		local PlayerPosition = GetEntityCoords(PlayerPed, false)

		Farm:ManageFields(PlayerPed, PlayerPosition)
	end
end)

RegisterNetEvent("Farm.Sync")
AddEventHandler("Farm.Sync", function(FarmSync)
	for Index = 1, #FarmSync.Fields do
		Farm.Data.Fields[Index].Raked = FarmSync.Fields[Index].Raked
	end

	Farm.Data.Players = FarmSync.Players
end)